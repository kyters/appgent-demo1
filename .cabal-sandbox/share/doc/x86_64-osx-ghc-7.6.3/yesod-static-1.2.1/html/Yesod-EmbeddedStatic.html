<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Yesod.EmbeddedStatic</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Yesod-EmbeddedStatic.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">yesod-static-1.2.1: Static file serving subsite for Yesod Web Framework.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Yesod.EmbeddedStatic</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Subsite
</a></li><li><a href="#g:2">Generators
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>A subsite which serves static content which is embedded at compile time.
</p><p>At compile time, you supply a list of files, directories, processing functions (like javascript
 minification), and even custom content generators.  You can also specify the specific relative
 locations within the static subsite where these resources should appear.  The <code><a href="Yesod-EmbeddedStatic.html#v:mkEmbeddedStatic">mkEmbeddedStatic</a></code>
 function then computes the resources and embeds them directly into the executable at
 compile time, so that the original files do not need to be distributed along with
 the executable.  The content is also compressed and hashed at compile time, so that
 during runtime the compressed content can be sent directly on the wire with the appropriate
 HTTP header.  The precomputed hash is used for an ETag so the client does not redownload
 the content multiple times.  There is also a development mode which does not embed the
 contents but recomputes it on every request. A simple example using an embedded static
 subsite is
 <a href="https://github.com/yesodweb/yesod/blob/master/yesod-static/sample-embed.hs">static-embed.hs</a>.
</p><p>To add this to a scaffolded project, replace the code in <code>Settings/StaticFiles.hs</code>
 with a call to <code><a href="Yesod-EmbeddedStatic.html#v:mkEmbeddedStatic">mkEmbeddedStatic</a></code> with the list of all your generators, use the type
 <code><a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a></code> in your site datatype for <code>getStatic</code>, update the route for <code>/static</code> to
 use the type <code><a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a></code>, use <code><a href="Yesod-EmbeddedStatic.html#v:embedStaticContent">embedStaticContent</a></code> for <code><a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/yesod-core-1.2.5/html/Yesod-Core.html#v:addStaticContent">addStaticContent</a></code> in
 <code>Foundation.hs</code>, use the routes generated by <code><a href="Yesod-EmbeddedStatic.html#v:mkEmbeddedStatic">mkEmbeddedStatic</a></code> and exported by
 <code>Settings/StaticFiles.hs</code> to link to your static content, and finally update
 <code>Application.hs</code> use the variable binding created by <code><a href="Yesod-EmbeddedStatic.html#v:mkEmbeddedStatic">mkEmbeddedStatic</a></code> which
 contains the created <code><a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a></code>.
</p><p>It is recommended that you serve static resources from a separate domain to save time
 on transmitting cookies.  You can use <code><a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/yesod-core-1.2.5/html/Yesod-Core.html#v:urlRenderOverride">urlRenderOverride</a></code> to do so, by redirecting
 routes to this subsite to a different domain (but the same path) and then pointing the
 alternative domain to this server.  In addition, you might consider using a reverse
 proxy like varnish or squid to cache the static content, but the embedded content in
 this subsite is cached and served directly from memory so is already quite fast.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span>  <a href="#t:EmbeddedStatic">EmbeddedStatic</a> </li><li class="src short"><a href="#v:embeddedResourceR">embeddedResourceR</a> :: [<a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/text-0.11.3.1/html/Data-Text-Internal.html#t:Text">Text</a>] -&gt; [(<a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/text-0.11.3.1/html/Data-Text-Internal.html#t:Text">Text</a>, <a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/text-0.11.3.1/html/Data-Text-Internal.html#t:Text">Text</a>)] -&gt; <a href="Yesod-Static.html#t:Route">Route</a> <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a></li><li class="src short"><a href="#v:mkEmbeddedStatic">mkEmbeddedStatic</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a> -&gt; [<a href="Yesod-EmbeddedStatic-Types.html#t:Generator">Generator</a>] -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/template-haskell-2.8.0.0/Language-Haskell-TH-Syntax.html#t:Q">Q</a> [<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/template-haskell-2.8.0.0/Language-Haskell-TH-Syntax.html#t:Dec">Dec</a>]</li><li class="src short"><a href="#v:embedStaticContent">embedStaticContent</a> :: <a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/yesod-core-1.2.5/html/Yesod-Core.html#t:Yesod">Yesod</a> site =&gt; (site -&gt; <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a>) -&gt; (<a href="Yesod-Static.html#t:Route">Route</a> <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a> -&gt; <a href="Yesod-Static.html#t:Route">Route</a> site) -&gt; (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> a <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString-Lazy.html#t:ByteString">ByteString</a>) -&gt; AddStaticContent site</li><li class="src short">module <a href="Yesod-EmbeddedStatic-Generators.html">Yesod.EmbeddedStatic.Generators</a></li></ul></div><div id="interface"><h1 id="g:1">Subsite
</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:EmbeddedStatic" class="def">EmbeddedStatic</a>  </p><div class="doc"><p>The subsite for the embedded static file server.
</p></div><div class="subs instances"><p id="control.i:EmbeddedStatic" class="caption collapser" onclick="toggleSection('i:EmbeddedStatic')">Instances</p><div id="section.i:EmbeddedStatic" class="show"><table><tr><td class="src"><a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/yesod-core-1.2.5/html/Yesod-Core.html#t:ParseRoute">ParseRoute</a> <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/yesod-core-1.2.5/html/Yesod-Core.html#t:RenderRoute">RenderRoute</a> <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/yesod-core-1.2.5/html/Yesod-Core.html#t:Yesod">Yesod</a> master =&gt; <a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/yesod-core-1.2.5/html/Yesod-Core.html#t:YesodSubDispatch">YesodSubDispatch</a> <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a> (<a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/yesod-core-1.2.5/html/Yesod-Core-Types.html#t:HandlerT">HandlerT</a> master <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> (<a href="Yesod-Static.html#t:Route">Route</a> <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Read.html#t:Read">Read</a> (<a href="Yesod-Static.html#t:Route">Route</a> <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> (<a href="Yesod-Static.html#t:Route">Route</a> <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:embeddedResourceR" class="def">embeddedResourceR</a> :: [<a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/text-0.11.3.1/html/Data-Text-Internal.html#t:Text">Text</a>] -&gt; [(<a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/text-0.11.3.1/html/Data-Text-Internal.html#t:Text">Text</a>, <a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/text-0.11.3.1/html/Data-Text-Internal.html#t:Text">Text</a>)] -&gt; <a href="Yesod-Static.html#t:Route">Route</a> <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a></p><div class="doc"><p>Construct a route to an embedded resource.
</p></div></div><div class="top"><p class="src"><a name="v:mkEmbeddedStatic" class="def">mkEmbeddedStatic</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></td><td class="doc"><p>development?
</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a></td><td class="doc"><p>variable name for the created <code><a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a></code>
</p></td></tr><tr><td class="src">-&gt; [<a href="Yesod-EmbeddedStatic-Types.html#t:Generator">Generator</a>]</td><td class="doc"><p>the generators (see <a href="Yesod-EmbeddedStatic-Generators.html">Yesod.EmbeddedStatic.Generators</a>)
</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/template-haskell-2.8.0.0/Language-Haskell-TH-Syntax.html#t:Q">Q</a> [<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/template-haskell-2.8.0.0/Language-Haskell-TH-Syntax.html#t:Dec">Dec</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Creates an <code><a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a></code> by running, at compile time, a list of generators. 
 Each generator produces a list of entries to embed into the executable.
</p><p>This template haskell splice creates a variable binding holding the resulting
 <code><a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a></code> and in addition creates variable bindings for all the routes
 produced by the generators.  For example, if a directory called static has
 the following contents:
</p><ul><li> js/jquery.js
</li><li> css/bootstrap.css
</li><li> img/logo.png
</li></ul><p>then a call to
</p><pre> #ifdef DEVELOPMENT
 #define DEV_BOOL True
 #else
 #define DEV_BOOL False
 #endif
 mkEmbeddedStatic DEV_BOOL &quot;myStatic&quot; [embedDir &quot;static&quot;]
</pre><p>will produce variables
</p><pre> myStatic :: EmbeddedStatic
 js_jquery_js :: Route EmbeddedStatic
 css_bootstrap_css :: Route EmbeddedStatic
 img_logo_png :: Route EmbeddedStatic
</pre></div></div><div class="top"><p class="src"><a name="v:embedStaticContent" class="def">embedStaticContent</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/yesod-core-1.2.5/html/Yesod-Core.html#t:Yesod">Yesod</a> site</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (site -&gt; <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a>)</td><td class="doc"><p>How to retrieve the embedded static subsite from your site
</p></td></tr><tr><td class="src">-&gt; (<a href="Yesod-Static.html#t:Route">Route</a> <a href="Yesod-EmbeddedStatic.html#t:EmbeddedStatic">EmbeddedStatic</a> -&gt; <a href="Yesod-Static.html#t:Route">Route</a> site)</td><td class="doc"><p>how to convert an embedded static route
</p></td></tr><tr><td class="src">-&gt; (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> a <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString-Lazy.html#t:ByteString">ByteString</a>)</td><td class="doc"><p>javascript minifier
</p></td></tr><tr><td class="src">-&gt; AddStaticContent site</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Use this for <code><a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/yesod-core-1.2.5/html/Yesod-Core.html#v:addStaticContent">addStaticContent</a></code> to have the widget static content be served by
   the embedded static subsite.  For example,
</p><pre> import Yesod
 import Yesod.EmbeddedStatic
 import Text.Jasmine (minifym)

 data MySite = { ..., getStatic :: EmbeddedStatic, ... }

 mkYesod &quot;MySite&quot; [parseRoutes|
 ...
 /static StaticR EmbeddedStatic getStatic
 ...
 |]

 instance Yesod MySite where
     ...
     addStaticContent = embedStaticContent getStatic StaticR mini
         where mini = if development then Right else minifym
     ...
</pre></div></div><h1 id="g:2">Generators
</h1><div class="top"><p class="src">module <a href="Yesod-EmbeddedStatic-Generators.html">Yesod.EmbeddedStatic.Generators</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2</p></div></body></html>