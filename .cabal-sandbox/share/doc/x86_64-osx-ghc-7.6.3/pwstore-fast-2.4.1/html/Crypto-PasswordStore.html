<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Crypto.PasswordStore</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Crypto-PasswordStore.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">pwstore-fast-2.4.1: Secure password storage.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Portability</th><td>portable</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Maintainer</th><td>pjscott@iastate.edu</td></tr><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Crypto.PasswordStore</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Algorithms
</a></li><li><a href="#g:2">Registering and verifying passwords
</a></li><li><a href="#g:3">Updating password hash strength
</a></li><li><a href="#g:4">Utilities
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Securely store hashed, salted passwords. If you need to store and verify
 passwords, there are many wrong ways to do it, most of them all too
 common. Some people store users' passwords in plain text. Then, when an
 attacker manages to get their hands on this file, they have the passwords for
 every user's account. One step up, but still wrong, is to simply hash all
 passwords with SHA1 or something. This is vulnerable to rainbow table and
 dictionary attacks. One step up from that is to hash the password along with
 a unique salt value. This is vulnerable to dictionary attacks, since guessing
 a password is very fast. The right thing to do is to use a slow hash
 function, to add some small but significant delay, that will be negligible
 for legitimate users but prohibitively expensive for someone trying to guess
 passwords by brute force. That is what this library does. It iterates a
 SHA256 hash, with a random salt, a few thousand times. This scheme is known
 as PBKDF1, and is generally considered secure; there is nothing innovative
 happening here.
</p><p>The API here is very simple. What you store are called <em>password hashes</em>.
 They are strings (technically, ByteStrings) that look like this:
</p><pre> &quot;sha256|14|jEWU94phx4QzNyH94Qp4CQ==|5GEw+jxP/4WLgzt9VS3Ee3nhqBlDsrKiB+rq7JfMckU=&quot;
</pre><p>Each password hash shows the algorithm, the strength (more on that later),
 the salt, and the hashed-and-salted password. You store these on your server,
 in a database, for when you need to verify a password. You make a password
 hash with the <code><a href="Crypto-PasswordStore.html#v:makePassword">makePassword</a></code> function. Here's an example:
</p><pre> &gt;&gt;&gt; makePassword &quot;hunter2&quot; 14
 &quot;sha256|14|Zo4LdZGrv/HYNAUG3q8WcA==|zKjbHZoTpuPLp1lh6ATolWGIKjhXvY4TysuKvqtNFyk=&quot;
</pre><p>This will hash the password <code>&quot;hunter2&quot;</code>, with strength 12, which is a good
 default value. The strength here determines how long the hashing will
 take. When doing the hashing, we iterate the SHA256 hash function
 <code>2^strength</code> times, so increasing the strength by 1 makes the hashing take
 twice as long. When computers get faster, you can bump up the strength a
 little bit to compensate. You can strengthen existing password hashes with
 the <code><a href="Crypto-PasswordStore.html#v:strengthenPassword">strengthenPassword</a></code> function. Note that <code><a href="Crypto-PasswordStore.html#v:makePassword">makePassword</a></code> needs to generate
 random numbers, so its return type is <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a></code> <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></code>. If you want to avoid
 the <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a></code> monad, you can generate your own salt and pass it to
 <code><a href="Crypto-PasswordStore.html#v:makePasswordSalt">makePasswordSalt</a></code>.
</p><p>Your strength value should not be less than 12, and 14 is a good default
 value at the time of this writing, in 2013.
</p><p>Once you've got your password hashes, the second big thing you need to do
 with them is verify passwords against them. When a user gives you a password,
 you compare it with a password hash using the <code><a href="Crypto-PasswordStore.html#v:verifyPassword">verifyPassword</a></code> function:
</p><pre> &gt;&gt;&gt; verifyPassword &quot;wrong guess&quot; passwordHash
 False
 &gt;&gt;&gt; verifyPassword &quot;hunter2&quot; passwordHash
 True
</pre><p>These two functions are really all you need. If you want to make existing
 password hashes stronger, you can use <code><a href="Crypto-PasswordStore.html#v:strengthenPassword">strengthenPassword</a></code>. Just pass it an
 existing password hash and a new strength value, and it will return a new
 password hash with that strength value, which will match the same password as
 the old password hash.
</p><p>Note that, as of version 2.4, you can also use PBKDF2, and specify the exact
 iteration count. This does not have a significant effect on security, but can
 be handy for compatibility with other code.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:pbkdf1">pbkdf1</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:pbkdf2">pbkdf2</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:makePassword">makePassword</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:makePasswordWith">makePasswordWith</a> :: (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a>) -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:makePasswordSalt">makePasswordSalt</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:makePasswordSaltWith">makePasswordSaltWith</a> :: (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a>) -&gt; (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a>) -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:verifyPassword">verifyPassword</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:verifyPasswordWith">verifyPasswordWith</a> :: (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a>) -&gt; (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a>) -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:strengthenPassword">strengthenPassword</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:passwordStrength">passwordStrength</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></li><li class="src short"><span class="keyword">data</span>  <a href="#t:Salt">Salt</a> </li><li class="src short"><a href="#v:isPasswordFormatValid">isPasswordFormatValid</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:genSaltIO">genSaltIO</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="Crypto-PasswordStore.html#t:Salt">Salt</a></li><li class="src short"><a href="#v:genSaltRandom">genSaltRandom</a> :: <a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/random-1.0.1.1/html/System-Random.html#t:RandomGen">RandomGen</a> b =&gt; b -&gt; (<a href="Crypto-PasswordStore.html#t:Salt">Salt</a>, b)</li><li class="src short"><a href="#v:makeSalt">makeSalt</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a></li><li class="src short"><a href="#v:exportSalt">exportSalt</a> :: <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:importSalt">importSalt</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a></li></ul></div><div id="interface"><h1 id="g:1">Algorithms
</h1><div class="top"><p class="src"><a name="v:pbkdf1" class="def">pbkdf1</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></p><div class="doc"><p>PBKDF1 key-derivation function. Takes a password, a <code><a href="Crypto-PasswordStore.html#t:Salt">Salt</a></code>, and a number of
 iterations. The number of iterations should be at least 1000, and probably
 more. 5000 is a reasonable number, computing almost instantaneously. This
 will give a 32-byte <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></code> as output. Both the salt and this 32-byte
 key should be stored in the password file. When a user wishes to authenticate
 a password, just pass it and the salt to this function, and see if the output
 matches.
</p></div></div><div class="top"><p class="src"><a name="v:pbkdf2" class="def">pbkdf2</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></p><div class="doc"><p>PBKDF2 key-derivation function.
 For details see <code>http:<em></em>tools.ietf.org<em>html</em>rfc2898</code>.
 <code>32</code> is the most common digest size for <code>SHA256</code>, and is
 what the algorithm internally uses.
 <code>HMAC+SHA256</code> is used as <code>PRF</code>, because <code>HMAC+SHA1</code> is considered too weak.
</p></div></div><h1 id="g:2">Registering and verifying passwords
</h1><div class="top"><p class="src"><a name="v:makePassword" class="def">makePassword</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></p><div class="doc"><p>Hash a password with a given strength (14 is a good default). The output of
 this function can be written directly to a password file or
 database. Generates a salt using high-quality randomness from
 <code>/dev/urandom</code> or (if that is not available, for example on Windows)
 <code><a href="System.html#t:Random">Random</a></code>, which is included in the hashed output.
</p></div></div><div class="top"><p class="src"><a name="v:makePasswordWith" class="def">makePasswordWith</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a>)</td><td class="doc"><p>The algorithm to use (e.g. pbkdf1)
</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>The password to encrypt
</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>log2 of the number of iterations
</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>A generic version of <code><a href="Crypto-PasswordStore.html#v:makePassword">makePassword</a></code>, which allow the user
 to choose the algorithm to use.
</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>makePasswordWith pbkdf1 &quot;password&quot; 14
</code></strong></pre></div></div><div class="top"><p class="src"><a name="v:makePasswordSalt" class="def">makePasswordSalt</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></p><div class="doc"><p>Hash a password with a given strength (14 is a good default), using a given
 salt. The output of this function can be written directly to a password file
 or database. Example:
</p><pre> &gt;&gt;&gt; makePasswordSalt &quot;hunter2&quot; (makeSalt &quot;72cd18b5ebfe6e96&quot;) 14
 &quot;sha256|14|NzJjZDE4YjVlYmZlNmU5Ng==|yuiNrZW3KHX+pd0sWy9NTTsy5Yopmtx4UYscItSsoxc=&quot;
</pre></div></div><div class="top"><p class="src"><a name="v:makePasswordSaltWith" class="def">makePasswordSaltWith</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a>)</td><td class="doc"><p>A function modeling an algorithm (e.g. <code><a href="Crypto-PasswordStore.html#v:pbkdf1">pbkdf1</a></code>)
</p></td></tr><tr><td class="src">-&gt; (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a>)</td><td class="doc"><p>A function to modify the strength
</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>A password, given as clear text
</p></td></tr><tr><td class="src">-&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a></td><td class="doc"><p>A hash <code><a href="Crypto-PasswordStore.html#t:Salt">Salt</a></code>
</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The password strength (e.g. <code>10000, 20000, etc.</code>)
</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>A generic version of <code><a href="Crypto-PasswordStore.html#v:makePasswordSalt">makePasswordSalt</a></code>, meant to give the user
 the maximum control over the generation parameters.
 Note that, unlike <code><a href="Crypto-PasswordStore.html#v:makePasswordWith">makePasswordWith</a></code>, this function takes the <code>raw</code>
 number of iterations. This means the user will need to specify a
 sensible value, typically <code>10000</code> or <code>20000</code>.
</p></div></div><div class="top"><p class="src"><a name="v:verifyPassword" class="def">verifyPassword</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></p><div class="doc"><p>Like <code><a href="Crypto-PasswordStore.html#v:verifyPasswordWith">verifyPasswordWith</a></code>, but uses <code><a href="Crypto-PasswordStore.html#v:pbkdf1">pbkdf1</a></code> as algorithm.
</p></div></div><div class="top"><p class="src"><a name="v:verifyPasswordWith" class="def">verifyPasswordWith</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a>)</td><td class="doc"><p>A function modeling an algorithm (e.g. pbkdf1)
</p></td></tr><tr><td class="src">-&gt; (<a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a>)</td><td class="doc"><p>A function to modify the strength
</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>User password
</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>The generated hash (e.g. sha256|14...)
</p></td></tr><tr><td class="src">-&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p><code><a href="Crypto-PasswordStore.html#v:verifyPasswordWith">verifyPasswordWith</a></code> <code>algorithm userInput pwHash</code> verifies
 the password <code>userInput</code> given by the user against the stored password
 hash <code>pwHash</code>, with the hashing algorithm <code>algorithm</code>.  Returns <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#v:True">True</a></code> if the
 given password is correct, and <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#v:False">False</a></code> if it is not.
 This function allows the programmer to specify the algorithm to use,
 e.g. <code><a href="Crypto-PasswordStore.html#v:pbkdf1">pbkdf1</a></code> or <code><a href="Crypto-PasswordStore.html#v:pbkdf2">pbkdf2</a></code>.
 Note: If you want to verify a password previously generated with
 <code><a href="Crypto-PasswordStore.html#v:makePasswordSaltWith">makePasswordSaltWith</a></code>, but without modifying the number of iterations,
 you can do:
</p><pre> &gt;&gt;&gt; verifyPasswordWith pbkdf2 id &quot;hunter2&quot; &quot;sha256...&quot;
 True
</pre></div></div><h1 id="g:3">Updating password hash strength
</h1><div class="top"><p class="src"><a name="v:strengthenPassword" class="def">strengthenPassword</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></p><div class="doc"><p>Try to strengthen a password hash, by hashing it some more
 times. <code><code><a href="Crypto-PasswordStore.html#v:strengthenPassword">strengthenPassword</a></code> pwHash new_strength</code> will return a new password
 hash with strength at least <code>new_strength</code>. If the password hash already has
 strength greater than or equal to <code>new_strength</code>, then it is returned
 unmodified. If the password hash is invalid and does not parse, it will be
 returned without comment.
</p><p>This function can be used to periodically update your password database when
 computers get faster, in order to keep up with Moore's law. This isn't hugely
 important, but it's a good idea.
</p></div></div><div class="top"><p class="src"><a name="v:passwordStrength" class="def">passwordStrength</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></p><div class="doc"><p>Return the strength of a password hash.
</p></div></div><h1 id="g:4">Utilities
</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Salt" class="def">Salt</a>  </p><div class="doc"><p>A salt is a unique random value which is stored as part of the password
 hash. You can generate a salt with <code><a href="Crypto-PasswordStore.html#v:genSaltIO">genSaltIO</a></code> or <code><a href="Crypto-PasswordStore.html#v:genSaltRandom">genSaltRandom</a></code>, or if you
 really know what you're doing, you can create them from your own ByteString
 values with <code><a href="Crypto-PasswordStore.html#v:makeSalt">makeSalt</a></code>.
</p></div><div class="subs instances"><p id="control.i:Salt" class="caption collapser" onclick="toggleSection('i:Salt')">Instances</p><div id="section.i:Salt" class="show"><table><tr><td class="src"><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> <a href="Crypto-PasswordStore.html#t:Salt">Salt</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> <a href="Crypto-PasswordStore.html#t:Salt">Salt</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> <a href="Crypto-PasswordStore.html#t:Salt">Salt</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:isPasswordFormatValid" class="def">isPasswordFormatValid</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></p><div class="doc"><p>Is the format of a password hash valid? Attempts to parse a given password
 hash. Returns <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#v:True">True</a></code> if it parses correctly, and <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#v:False">False</a></code> otherwise.
</p></div></div><div class="top"><p class="src"><a name="v:genSaltIO" class="def">genSaltIO</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="Crypto-PasswordStore.html#t:Salt">Salt</a></p><div class="doc"><p>Generate a <code><a href="Crypto-PasswordStore.html#t:Salt">Salt</a></code> from 128 bits of data from <code>/dev/urandom</code>, with the
 system RNG as a fallback. This is the function used to generate salts by
 <code><a href="Crypto-PasswordStore.html#v:makePassword">makePassword</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:genSaltRandom" class="def">genSaltRandom</a> :: <a href="file:///Users/dvekeman/github-vircures/appgent-ekiden-demo/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/random-1.0.1.1/html/System-Random.html#t:RandomGen">RandomGen</a> b =&gt; b -&gt; (<a href="Crypto-PasswordStore.html#t:Salt">Salt</a>, b)</p><div class="doc"><p>Generate a <code><a href="Crypto-PasswordStore.html#t:Salt">Salt</a></code> with 128 bits of data taken from a given random number
 generator. Returns the salt and the updated random number generator. This is
 meant to be used with <code><a href="Crypto-PasswordStore.html#v:makePasswordSalt">makePasswordSalt</a></code> by people who would prefer to either
 use their own random number generator or avoid the <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a></code> monad.
</p></div></div><div class="top"><p class="src"><a name="v:makeSalt" class="def">makeSalt</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a></p><div class="doc"><p>Create a <code><a href="Crypto-PasswordStore.html#t:Salt">Salt</a></code> from a <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></code>. The input must be at least 8
 characters, and can contain arbitrary bytes. Most users will not need to use
 this function.
</p></div></div><div class="top"><p class="src"><a name="v:exportSalt" class="def">exportSalt</a> :: <a href="Crypto-PasswordStore.html#t:Salt">Salt</a> -&gt; <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></p><div class="doc"><p>Convert a <code><a href="Crypto-PasswordStore.html#t:Salt">Salt</a></code> into a <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></code>. The resulting <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></code> will be
 base64-encoded. Most users will not need to use this function.
</p></div></div><div class="top"><p class="src"><a name="v:importSalt" class="def">importSalt</a> :: <a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Crypto-PasswordStore.html#t:Salt">Salt</a></p><div class="doc"><p>Convert a raw <code><a href="file:///usr/local/Cellar/ghc/7.6.3/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></code> into a <code><a href="Crypto-PasswordStore.html#t:Salt">Salt</a></code>.
 Use this function with caution, since using a weak salt will result in a
 weak password.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2</p></div></body></html>